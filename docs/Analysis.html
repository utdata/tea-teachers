<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AnalysisTEASalaries – tea-teachers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">tea-teachers</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./CleaningTEASalaries.html"> 
<span class="menu-text">Cleaning TEA Salaries</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./CleaningEnrollment.html"> 
<span class="menu-text">Cleaning TEA Enrollment</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./CleaningCPI-ALICE.html"> 
<span class="menu-text">Cleaning CPI and ALICE</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./Analysis.html" aria-current="page"> 
<span class="menu-text">Analysis</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#read-in-cleaned-data" id="toc-read-in-cleaned-data" class="nav-link" data-scroll-target="#read-in-cleaned-data">Read in cleaned data</a></li>
  <li><a href="#with-district-types" id="toc-with-district-types" class="nav-link" data-scroll-target="#with-district-types">With District Types</a>
  <ul class="collapse">
  <li><a href="#chart" id="toc-chart" class="nav-link" data-scroll-target="#chart">Chart</a></li>
  </ul></li>
  <li><a href="#adding-cost-of-living" id="toc-adding-cost-of-living" class="nav-link" data-scroll-target="#adding-cost-of-living">Adding Cost of Living</a></li>
  <li><a href="#region-13" id="toc-region-13" class="nav-link" data-scroll-target="#region-13">Region 13</a></li>
  <li><a href="#bill-categories" id="toc-bill-categories" class="nav-link" data-scroll-target="#bill-categories">Bill Categories</a></li>
  <li><a href="#proportion-of-districts-with-salary-above-and-below-alice-line" id="toc-proportion-of-districts-with-salary-above-and-below-alice-line" class="nav-link" data-scroll-target="#proportion-of-districts-with-salary-above-and-below-alice-line">Proportion of districts with salary above and below alice line</a></li>
  <li><a href="#proportion-abovebelow-alice-over-time" id="toc-proportion-abovebelow-alice-over-time" class="nav-link" data-scroll-target="#proportion-abovebelow-alice-over-time">Proportion above/below alice over time</a></li>
  <li><a href="#average-and-median-salary-and-alice-threshold-for-each-category" id="toc-average-and-median-salary-and-alice-threshold-for-each-category" class="nav-link" data-scroll-target="#average-and-median-salary-and-alice-threshold-for-each-category">Average and median salary and alice threshold for each category</a></li>
  <li><a href="#nces-district-types" id="toc-nces-district-types" class="nav-link" data-scroll-target="#nces-district-types">NCES District Types</a>
  <ul class="collapse">
  <li><a href="#count-and-average-pay-for-nces" id="toc-count-and-average-pay-for-nces" class="nav-link" data-scroll-target="#count-and-average-pay-for-nces">Count and Average Pay for NCES</a></li>
  <li><a href="#average-and-median-of-difference-between-salary-and-alice-for-each-nces-district-type" id="toc-average-and-median-of-difference-between-salary-and-alice-for-each-nces-district-type" class="nav-link" data-scroll-target="#average-and-median-of-difference-between-salary-and-alice-for-each-nces-district-type">Average and Median of difference between salary and ALICE for each NCES district type</a></li>
  <li><a href="#same-as-above-but-for-region-13" id="toc-same-as-above-but-for-region-13" class="nav-link" data-scroll-target="#same-as-above-but-for-region-13">Same as above but for region 13</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AnalysisTEASalaries</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.2     ✔ readr     2.1.4
✔ forcats   1.0.0     ✔ stringr   1.5.0
✔ ggplot2   3.4.3     ✔ tibble    3.2.1
✔ lubridate 1.9.2     ✔ tidyr     1.3.0
✔ purrr     1.0.2     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'janitor'

The following objects are masked from 'package:stats':

    chisq.test, fisher.test</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'scales'

The following object is masked from 'package:purrr':

    discard

The following object is masked from 'package:readr':

    col_factor</code></pre>
</div>
</div>
</section>
<section id="read-in-cleaned-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-cleaned-data">Read in cleaned data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_salaries <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/teaching_staff_salaries.rds"</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>cpi <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/cpi_201401_202502"</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>household_budget_simple <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/alice_household_budget.rds"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>enrollment <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/enrollment-by-district.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I want to only look at totals for teaching staff at each district. I also want to exclude charters and exclude the weird small pay amounts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals_no_enroll <span class="ot">&lt;-</span> teaching_staff_salaries <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(staff <span class="sc">==</span> <span class="st">"TOTAL TEACHING STAFF"</span> <span class="sc">&amp;</span> average_base_pay <span class="sc">&gt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> charter_status <span class="sc">==</span> <span class="st">"TRADITIONAL ISD/CSD"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals_no_enroll</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 18
   region county   district_number district_name.x charter_status staff_category
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
 1 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 2 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
 3 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
 4 07     ANDERSO… 001906          NECHES ISD      TRADITIONAL I… TEACHING STAFF
 5 07     ANDERSO… 001907          PALESTINE ISD   TRADITIONAL I… TEACHING STAFF
 6 07     ANDERSO… 001908          WESTWOOD ISD    TRADITIONAL I… TEACHING STAFF
 7 07     ANDERSO… 001909          SLOCUM ISD      TRADITIONAL I… TEACHING STAFF
 8 18     ANDREWS… 002901          ANDREWS ISD     TRADITIONAL I… TEACHING STAFF
 9 07     ANGELIN… 003902          HUDSON ISD      TRADITIONAL I… TEACHING STAFF
10 07     ANGELIN… 003903          LUFKIN ISD      TRADITIONAL I… TEACHING STAFF
# ℹ 9,312 more rows
# ℹ 12 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;fct&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;</code></pre>
</div>
</div>
<p>I want to add enrollment to this dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="ot">&lt;-</span> teaching_staff_totals_no_enroll <span class="sc">|&gt;</span> </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(enrollment, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"district_name.x"</span> <span class="ot">=</span> <span class="st">"district_name"</span>, <span class="st">"school_year"</span> <span class="ot">=</span> <span class="st">"year"</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
  region county    district_number district_name.x charter_status staff_category
  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
1 03     DEWITT C… 062903          YOAKUM ISD      TRADITIONAL I… TEACHING STAFF
2 03     DEWITT C… 062904          YORKTOWN ISD    TRADITIONAL I… TEACHING STAFF
3 19     EL PASO … 071905          YSLETA ISD      TRADITIONAL I… TEACHING STAFF
4 01     ZAPATA C… 253901          ZAPATA COUNTY … TRADITIONAL I… TEACHING STAFF
5 07     ANGELINA… 003906          ZAVALLA ISD     TRADITIONAL I… TEACHING STAFF
6 15     BROWN CO… 025906          ZEPHYR ISD      TRADITIONAL I… TEACHING STAFF
# ℹ 13 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;chr&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;,
#   total_enrollment &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now let’s look at the average pay per district per year so we can look at it over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_average_school_years <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(district_name.x, school_year) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'district_name.x'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_average_school_years</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,222 × 3
# Groups:   district_name.x [1,023]
   district_name.x school_year avg_pay
   &lt;chr&gt;           &lt;chr&gt;         &lt;dbl&gt;
 1 ABBOTT ISD      2014-2015     42066
 2 ABBOTT ISD      2015-2016     43863
 3 ABBOTT ISD      2016-2017     43346
 4 ABBOTT ISD      2017-2018     45447
 5 ABBOTT ISD      2018-2019     44707
 6 ABBOTT ISD      2019-2020     52540
 7 ABBOTT ISD      2020-2021     51449
 8 ABBOTT ISD      2021-2022     54155
 9 ABBOTT ISD      2022-2023     55584
10 ABBOTT ISD      2023-2024     54927
# ℹ 9,212 more rows</code></pre>
</div>
</div>
<p>Okay there’s too many schools for us to graph these all at once. Maybe if we just do one region (central texas, 13).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>austin_schools <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"13"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(district_name.x, school_year) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'district_name.x'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>austin_schools</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 483 × 3
# Groups:   district_name.x [57]
   district_name.x school_year avg_pay
   &lt;chr&gt;           &lt;chr&gt;         &lt;dbl&gt;
 1 AUSTIN ISD      2014-2015     47476
 2 AUSTIN ISD      2015-2016     48631
 3 AUSTIN ISD      2016-2017     50144
 4 AUSTIN ISD      2017-2018     52397
 5 AUSTIN ISD      2018-2019     51464
 6 AUSTIN ISD      2019-2020     54707
 7 AUSTIN ISD      2020-2021     55849
 8 AUSTIN ISD      2021-2022     56424
 9 AUSTIN ISD      2022-2023     58511
10 AUSTIN ISD      2023-2024     60821
# ℹ 473 more rows</code></pre>
</div>
</div>
<p>That’s still too many to be understandable on a graph. Let’s instead look at just one district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>austin <span class="ot">&lt;-</span> austin_schools <span class="sc">|&gt;</span> <span class="fu">filter</span>(district_name.x <span class="sc">==</span> <span class="st">"AUSTIN ISD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(austin, <span class="fu">aes</span>(<span class="at">x =</span> school_year, <span class="at">y =</span> avg_pay, <span class="at">color =</span> district_name.x, <span class="at">group =</span> district_name.x)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~district_name)    # we can use this if we are looking at multiple districts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-district-types" class="level2">
<h2 class="anchored" data-anchor-id="with-district-types">With District Types</h2>
<p>I want to see how many districts are in each category from TEA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
# Groups:   tea_description [9]
  tea_description                   n
  &lt;chr&gt;                         &lt;int&gt;
1 Independent Town                489
2 Major Suburban                  677
3 Major Urban                     101
4 Non-metropolitan Fast Growing   311
5 Non-metropolitan Stable        1647
6 Other Central City              321
7 Other Central City Suburban    1519
8 Rural                          4233
9 &lt;NA&gt;                             24</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cumulation of years - need to look at one year at a time</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I see that there is “N/A” and NA values. Let’s combine those into one category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">tea_description =</span> tea_description <span class="sc">|&gt;</span> <span class="fu">na_if</span> (<span class="st">"N/A"</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I want to see the average pay for each TEA district type for each school year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>district_types_tea_chart <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, school_year) <span class="sc">|&gt;</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>district_types_tea_chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 3
# Groups:   tea_description [9]
   tea_description  school_year avg_pay
   &lt;chr&gt;            &lt;chr&gt;         &lt;dbl&gt;
 1 Independent Town 2014-2015    45775.
 2 Independent Town 2015-2016    46330.
 3 Independent Town 2016-2017    46938.
 4 Independent Town 2017-2018    47376.
 5 Independent Town 2018-2019    47945.
 6 Independent Town 2019-2020    51791.
 7 Independent Town 2020-2021    52313.
 8 Independent Town 2021-2022    52986.
 9 Independent Town 2022-2023    54895.
10 Independent Town 2023-2024    57213.
# ℹ 77 more rows</code></pre>
</div>
</div>
<section id="chart" class="level3">
<h3 class="anchored" data-anchor-id="chart">Chart</h3>
<p>Now let’s chart it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(district_types_tea_chart, <span class="fu">aes</span>(<span class="at">x =</span> school_year, <span class="at">y =</span> avg_pay, <span class="at">color =</span> tea_description, <span class="at">group =</span> tea_description)) <span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="adding-cost-of-living" class="level2">
<h2 class="anchored" data-anchor-id="adding-cost-of-living">Adding Cost of Living</h2>
<p>Now that we have ALICE’s household survival budget, I can use it to compare that to each districts salaries.</p>
<p>First, I am going to clean up the ALICE data so I can join it with my salary data.</p>
<p>Now, I am going to left join it on both the county and year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>salaries_col <span class="ot">&lt;-</span> <span class="fu">left_join</span>(teaching_staff_totals, household_budget_simple, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"county"</span>, <span class="st">"end_year"</span>))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>salaries_col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 20
   region county   district_number district_name.x charter_status staff_category
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
 1 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 2 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
 3 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
 4 07     ANDERSO… 001906          NECHES ISD      TRADITIONAL I… TEACHING STAFF
 5 07     ANDERSO… 001907          PALESTINE ISD   TRADITIONAL I… TEACHING STAFF
 6 07     ANDERSO… 001908          WESTWOOD ISD    TRADITIONAL I… TEACHING STAFF
 7 07     ANDERSO… 001909          SLOCUM ISD      TRADITIONAL I… TEACHING STAFF
 8 18     ANDREWS… 002901          ANDREWS ISD     TRADITIONAL I… TEACHING STAFF
 9 07     ANGELIN… 003902          HUDSON ISD      TRADITIONAL I… TEACHING STAFF
10 07     ANGELIN… 003903          LUFKIN ISD      TRADITIONAL I… TEACHING STAFF
# ℹ 9,312 more rows
# ℹ 14 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;chr&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;,
#   total_enrollment &lt;dbl&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>There are a few years that are inconsistent between the datasets. But since I have data around each year, I can use that. For example, I want to use 2016 for 2015 when needed. But, I also want to use 2022 for 2024 when needed. So I am going to fill up first, then down in each county.</p>
<p>First, I am going to it out with a single district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>testing_filling <span class="ot">&lt;-</span> salaries_col <span class="sc">|&gt;</span> <span class="fu">filter</span>(county <span class="sc">==</span> <span class="st">"ANDERSON COUNTY"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  county, district_name.x, school_year, end_year, alice_threshold_hh_under_65) <span class="sc">|&gt;</span> </span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(alice_threshold_hh_under_65, <span class="at">.direction =</span> <span class="st">"updown"</span>)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>testing_filling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 63 × 5
   county          district_name.x school_year end_year alice_threshold_hh_und…¹
   &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;                       &lt;dbl&gt;
 1 ANDERSON COUNTY CAYUGA ISD      2014-2015   2015                        50000
 2 ANDERSON COUNTY ELKHART ISD     2014-2015   2015                        50000
 3 ANDERSON COUNTY FRANKSTON ISD   2014-2015   2015                        50000
 4 ANDERSON COUNTY NECHES ISD      2014-2015   2015                        50000
 5 ANDERSON COUNTY PALESTINE ISD   2014-2015   2015                        50000
 6 ANDERSON COUNTY WESTWOOD ISD    2014-2015   2015                        50000
 7 ANDERSON COUNTY SLOCUM ISD      2014-2015   2015                        50000
 8 ANDERSON COUNTY CAYUGA ISD      2015-2016   2016                        50000
 9 ANDERSON COUNTY ELKHART ISD     2015-2016   2016                        50000
10 ANDERSON COUNTY FRANKSTON ISD   2015-2016   2016                        50000
# ℹ 53 more rows
# ℹ abbreviated name: ¹​alice_threshold_hh_under_65</code></pre>
</div>
</div>
<p>Actually, I want to fill down first then up, because I want to use the previous year when necessary instead of a future year and then for 2015 I will use 2016.</p>
<p>I’ll do it for all of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>salaries_col_fill <span class="ot">&lt;-</span> salaries_col <span class="sc">|&gt;</span> <span class="fu">arrange</span>(county, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(alice_threshold_hh_under_65, <span class="at">.direction =</span> <span class="st">"downup"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>salaries_col_fill</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 20
# Groups:   county [253]
   region county   district_number district_name.x charter_status staff_category
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
 1 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 2 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
 3 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
 4 07     ANDERSO… 001906          NECHES ISD      TRADITIONAL I… TEACHING STAFF
 5 07     ANDERSO… 001907          PALESTINE ISD   TRADITIONAL I… TEACHING STAFF
 6 07     ANDERSO… 001908          WESTWOOD ISD    TRADITIONAL I… TEACHING STAFF
 7 07     ANDERSO… 001909          SLOCUM ISD      TRADITIONAL I… TEACHING STAFF
 8 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 9 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
10 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
# ℹ 9,312 more rows
# ℹ 14 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;chr&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;,
#   total_enrollment &lt;dbl&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now I want to see the difference between the ALICE budget and the average salary for each district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="ot">&lt;-</span> salaries_col_fill <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> (average_base_pay <span class="sc">-</span> alice_threshold_hh_under_65) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>()</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  region, county, <span class="st">"district_name"</span> <span class="ot">=</span> <span class="st">"district_name.x"</span>, total_enrollment, average_base_pay, school_year, end_year, tea_description, nces_description, alice_threshold_hh_under_65, difference</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>salary_col_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 11
# Groups:   county [253]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 07     ANDERSON … CAYUGA ISD                 577            44925 2014-2015  
 2 07     ANDERSON … ELKHART ISD               1217            41985 2014-2015  
 3 07     ANDERSON … FRANKSTON ISD              803            41609 2014-2015  
 4 07     ANDERSON … NECHES ISD                 370            42884 2014-2015  
 5 07     ANDERSON … PALESTINE ISD             3353            43642 2014-2015  
 6 07     ANDERSON … WESTWOOD ISD              1596            42097 2014-2015  
 7 07     ANDERSON … SLOCUM ISD                 389            44371 2014-2015  
 8 07     ANDERSON … CAYUGA ISD                 570            45359 2015-2016  
 9 07     ANDERSON … ELKHART ISD               1244            44248 2015-2016  
10 07     ANDERSON … FRANKSTON ISD              842            43165 2015-2016  
# ℹ 9,312 more rows
# ℹ 5 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Let’s look at the districts with the lowest values for difference in salary and ALICE, which means the most negative. I want to see the worst 10 for each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(end_year) <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(difference, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 11
# Groups:   end_year [10]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 13     WILLIAMSO… COUPLAND ISD               142            38142 2014-2015  
 2 15     EDWARDS C… ROCKSPRINGS …              257            38959 2014-2015  
 3 15     EDWARDS C… NUECES CANYO…              297            39233 2014-2015  
 4 15     CONCHO CO… PAINT ROCK I…              211            40007 2014-2015  
 5 10     ELLIS COU… ITALY ISD                  577            40555 2014-2015  
 6 18     REEVES CO… BALMORHEA ISD              161            40923 2014-2015  
 7 13     WILLIAMSO… GRANGER ISD                426            41634 2014-2015  
 8 06     WALKER CO… NEW WAVERLY …              964            41915 2014-2015  
 9 10     ELLIS COU… PALMER ISD                1145            42028 2014-2015  
10 13     WILLIAMSO… THRALL ISD                 655            42164 2014-2015  
# ℹ 90 more rows
# ℹ 5 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now let’s see the best 10 for each year (most positive).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(end_year) <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(difference, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 11
# Groups:   end_year [10]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 20     KERR COUN… DIVIDE ISD            -9999993            63861 2014-2015  
 2 17     KENT COUN… JAYTON-GIRAR…              130            51405 2014-2015  
 3 11     SOMERVELL… GLEN ROSE ISD             1667            55351 2014-2015  
 4 17     BORDEN CO… BORDEN COUNT…              249            60208 2014-2015  
 5 03     MATAGORDA… PALACIOS ISD              1442            54612 2014-2015  
 6 04     CHAMBERS … BARBERS HILL…             4903            64376 2014-2015  
 7 18     TERRELL C… TERRELL COUN…              142            49273 2014-2015  
 8 18     BREWSTER … SAN VICENTE …               29            48777 2014-2015  
 9 16     OLDHAM CO… BOYS RANCH I…              281            53602 2014-2015  
10 17     KING COUN… GUTHRIE CSD                115            53465 2014-2015  
# ℹ 90 more rows
# ℹ 5 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now I want to see the average difference, median difference and count of districts for each TEA district type category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference),</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">number_of_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>            <span class="co"># fix number of districts, maybe</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(avg_difference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  tea_description           avg_difference median_difference number_of_districts
  &lt;chr&gt;                              &lt;dbl&gt;             &lt;dbl&gt;               &lt;int&gt;
1 Non-metropolitan Fast Gr…         -5368.             -4581                 311
2 &lt;NA&gt;                              -3055.             -2348                  24
3 Other Central City Subur…         -1702.             -1109                1519
4 Non-metropolitan Stable           -1300.              -527                1647
5 Rural                             -1043.              -719                4233
6 Independent Town                   -420.                60                 489
7 Other Central City                  205.               566                 321
8 Major Suburban                      673.              1243                 677
9 Major Urban                        1813.              2157                 101</code></pre>
</div>
</div>
<p>Now I want to look at the average difference over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time <span class="ot">&lt;-</span> salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 3
# Groups:   tea_description [9]
   tea_description  end_year avg_difference
   &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;
 1 Independent Town 2015               398.
 2 Independent Town 2016               952.
 3 Independent Town 2017              1560.
 4 Independent Town 2018             -2813.
 5 Independent Town 2019             -3092.
 6 Independent Town 2020               753.
 7 Independent Town 2021              -234.
 8 Independent Town 2022             -5187.
 9 Independent Town 2023             -1271.
10 Independent Town 2024              1047.
# ℹ 77 more rows</code></pre>
</div>
</div>
<p>Let’s graph it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_difference_over_time, </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, <span class="at">y =</span> avg_difference, <span class="at">color =</span> tea_description, <span class="at">group =</span> tea_description)) <span class="sc">+</span> </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>,<span class="dv">5000</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="region-13" class="level2">
<h2 class="anchored" data-anchor-id="region-13">Region 13</h2>
<p>All of the above for region 13…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>region_13 <span class="ot">&lt;-</span> salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="dv">13</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>region_13</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 483 × 11
# Groups:   county [17]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 13     BASTROP C… BASTROP ISD               9928            48385 2014-2015  
 2 13     BASTROP C… ELGIN ISD                 4277            48130 2014-2015  
 3 13     BASTROP C… SMITHVILLE I…             1763            46003 2014-2015  
 4 13     BASTROP C… MCDADE ISD                 206            42880 2014-2015  
 5 13     BASTROP C… BASTROP ISD              10278            49383 2015-2016  
 6 13     BASTROP C… ELGIN ISD                 4321            47990 2015-2016  
 7 13     BASTROP C… SMITHVILLE I…             1788            46797 2015-2016  
 8 13     BASTROP C… MCDADE ISD                 221            43444 2015-2016  
 9 13     BASTROP C… BASTROP ISD              10539            49716 2016-2017  
10 13     BASTROP C… ELGIN ISD                 4317            49395 2016-2017  
# ℹ 473 more rows
# ℹ 5 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>region_13 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(end_year) <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(difference, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 94 × 11
# Groups:   end_year [10]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 13     WILLIAMSO… COUPLAND ISD               142            38142 2014-2015  
 2 13     WILLIAMSO… GRANGER ISD                426            41634 2014-2015  
 3 13     WILLIAMSO… THRALL ISD                 655            42164 2014-2015  
 4 13     BASTROP C… MCDADE ISD                 206            42880 2014-2015  
 5 13     WILLIAMSO… FLORENCE ISD               995            43048 2014-2015  
 6 13     CALDWELL … LULING ISD                1384            44583 2014-2015  
 7 13     WILLIAMSO… TAYLOR ISD                3231            44954 2014-2015  
 8 13     CALDWELL … PRAIRIE LEA …              163            45364 2014-2015  
 9 13     WILLIAMSO… JARRELL ISD               1265            45745 2014-2015  
10 13     BASTROP C… SMITHVILLE I…             1763            46003 2014-2015  
# ℹ 84 more rows
# ℹ 5 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>region_13 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(end_year) <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(difference, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 94 × 11
# Groups:   end_year [10]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 13     LLANO COU… LLANO ISD                 1797            47705 2014-2015  
 2 13     FAYETTE C… LA GRANGE ISD             1885            46702 2014-2015  
 3 13     BLANCO CO… BLANCO ISD                 998            50951 2014-2015  
 4 13     MILAM COU… THORNDALE ISD              604            45168 2014-2015  
 5 13     BLANCO CO… JOHNSON CITY…              683            49985 2014-2015  
 6 13     GILLESPIE… HARPER ISD                 610            49643 2014-2015  
 7 13     GILLESPIE… FREDERICKSBU…             3009            49620 2014-2015  
 8 13     FAYETTE C… SCHULENBURG …              713            44292 2014-2015  
 9 13     BURNET CO… MARBLE FALLS…             4064            48453 2014-2015  
10 13     FAYETTE C… ROUND TOP-CA…              284            43077 2014-2015  
# ℹ 84 more rows
# ℹ 5 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>region_13 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference),</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference),</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">number_of_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(avg_difference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  tea_description           avg_difference median_difference number_of_districts
  &lt;chr&gt;                              &lt;dbl&gt;             &lt;dbl&gt;               &lt;int&gt;
1 Other Central City               -16681.           -17970.                  10
2 Non-metropolitan Fast Gr…         -8729.            -5972                   37
3 Other Central City Subur…         -8645.            -6437                  103
4 Major Suburban                    -5531.            -4821                   86
5 Major Urban                       -5215.            -5332                   10
6 Rural                             -4469.             -953                  124
7 Non-metropolitan Stable           -3736.            -1511                   86
8 Independent Town                   2216.             2219                   27</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time_13 <span class="ot">&lt;-</span> region_13 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference, <span class="at">na.rm =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time_13</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 76 × 3
# Groups:   tea_description [8]
   tea_description  end_year avg_difference
   &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;
 1 Independent Town 2015              4925 
 2 Independent Town 2016              5459.
 3 Independent Town 2017              5515.
 4 Independent Town 2018              -404.
 5 Independent Town 2019              -255.
 6 Independent Town 2020              1607.
 7 Independent Town 2021             -1508.
 8 Independent Town 2023              1342.
 9 Independent Town 2024              3266.
10 Major Suburban   2015             -4920.
# ℹ 66 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_difference_over_time_13, </span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, <span class="at">y =</span> avg_difference, <span class="at">color =</span> tea_description, <span class="at">group =</span> tea_description)) <span class="sc">+</span> </span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>,<span class="dv">5000</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 9 rows containing missing values (`geom_line()`).</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="bill-categories" class="level2">
<h2 class="anchored" data-anchor-id="bill-categories">Bill Categories</h2>
<p>I am going to create a bill category column that includes the different categories the SB and HB have defined as important to the bill. These numbers incluse 5000, 1600 and 300.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="ot">&lt;-</span>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">bill_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&gt;=</span> <span class="dv">5000</span> <span class="sc">~</span> <span class="st">"over 5000"</span>,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&lt;</span> <span class="dv">300</span> <span class="sc">~</span> <span class="st">"under 300"</span>,</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&lt;</span> <span class="dv">1600</span> <span class="sc">~</span> <span class="st">"under 1600"</span>,</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&lt;</span> <span class="dv">5000</span> <span class="sc">~</span> <span class="st">"under 5000"</span>)</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bill_category =</span> <span class="fu">factor</span>(bill_category, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"under 300"</span>, <span class="st">"under 1600"</span>, <span class="st">"under 5000"</span>, <span class="st">"over 5000"</span>))</span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>bill_category_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 12
# Groups:   county [253]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 07     ANDERSON … CAYUGA ISD                 577            44925 2014-2015  
 2 07     ANDERSON … ELKHART ISD               1217            41985 2014-2015  
 3 07     ANDERSON … FRANKSTON ISD              803            41609 2014-2015  
 4 07     ANDERSON … NECHES ISD                 370            42884 2014-2015  
 5 07     ANDERSON … PALESTINE ISD             3353            43642 2014-2015  
 6 07     ANDERSON … WESTWOOD ISD              1596            42097 2014-2015  
 7 07     ANDERSON … SLOCUM ISD                 389            44371 2014-2015  
 8 07     ANDERSON … CAYUGA ISD                 570            45359 2015-2016  
 9 07     ANDERSON … ELKHART ISD               1244            44248 2015-2016  
10 07     ANDERSON … FRANKSTON ISD              842            43165 2015-2016  
# ℹ 9,312 more rows
# ℹ 6 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;,
#   difference &lt;dbl&gt;, bill_category &lt;fct&gt;</code></pre>
</div>
</div>
<p>I am going to use the column bill_category to look at what the col vs salary looks like for the categories the bill wants to target. This is the same concept as above but for these bill categories instead of tea categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference, <span class="at">na.rm =</span> T),</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference, <span class="at">na.rm =</span> T),</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  bill_category avg_difference median_difference total_districts
  &lt;fct&gt;                  &lt;dbl&gt;             &lt;dbl&gt;           &lt;int&gt;
1 under 300             -1291.            -1058             1861
2 under 1600            -1426.             -822.            3930
3 under 5000            -1451.             -680             1819
4 over 5000               151.              616             1712</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>avg_difference_bill_category <span class="ot">&lt;-</span> bill_category_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference, <span class="at">na.rm =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'bill_category'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>avg_difference_bill_category</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
# Groups:   bill_category [4]
   bill_category end_year avg_difference
   &lt;fct&gt;         &lt;chr&gt;             &lt;dbl&gt;
 1 under 300     2015             -1794.
 2 under 300     2016              -951.
 3 under 300     2017              -511.
 4 under 300     2018             -4323.
 5 under 300     2019             -3810.
 6 under 300     2020              1470.
 7 under 300     2021             -1109.
 8 under 300     2022             -6138.
 9 under 300     2023              -709.
10 under 300     2024               649.
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_difference_bill_category, </span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, <span class="at">y =</span> avg_difference, <span class="at">color =</span> bill_category, <span class="at">group =</span> bill_category)) <span class="sc">+</span> </span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>,<span class="dv">5000</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="proportion-of-districts-with-salary-above-and-below-alice-line" class="level2">
<h2 class="anchored" data-anchor-id="proportion-of-districts-with-salary-above-and-below-alice-line">Proportion of districts with salary above and below alice line</h2>
<p>I want to know how many districts have salaries that meet the ALICE line or not. And find the proportion of of those districts for each TEA district type and based on the bill categories for districts.</p>
<p>First, I want to create a column that indicates if the salary is above or below ALICE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in a district category whats the number of districts where the salary is below alice for that district dividied by the total number of districts in that category</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="ot">&lt;-</span> bill_category_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">above_alice =</span> <span class="fu">case_when</span>(</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>    average_base_pay <span class="sc">&gt;=</span> alice_threshold_hh_under_65 <span class="sc">~</span> T,</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> F</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>above_below_alice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 13
# Groups:   county [253]
   region county     district_name total_enrollment average_base_pay school_year
   &lt;chr&gt;  &lt;chr&gt;      &lt;chr&gt;                    &lt;dbl&gt;            &lt;dbl&gt; &lt;chr&gt;      
 1 07     ANDERSON … CAYUGA ISD                 577            44925 2014-2015  
 2 07     ANDERSON … ELKHART ISD               1217            41985 2014-2015  
 3 07     ANDERSON … FRANKSTON ISD              803            41609 2014-2015  
 4 07     ANDERSON … NECHES ISD                 370            42884 2014-2015  
 5 07     ANDERSON … PALESTINE ISD             3353            43642 2014-2015  
 6 07     ANDERSON … WESTWOOD ISD              1596            42097 2014-2015  
 7 07     ANDERSON … SLOCUM ISD                 389            44371 2014-2015  
 8 07     ANDERSON … CAYUGA ISD                 570            45359 2015-2016  
 9 07     ANDERSON … ELKHART ISD               1244            44248 2015-2016  
10 07     ANDERSON … FRANKSTON ISD              842            43165 2015-2016  
# ℹ 9,312 more rows
# ℹ 7 more variables: end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;,
#   difference &lt;dbl&gt;, bill_category &lt;fct&gt;, above_alice &lt;lgl&gt;</code></pre>
</div>
</div>
<p>Now I am goint to count the number of districts below alice, count the total number of districts in each tea district group and then calculate the proportion of districts that fall below the line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  tea_description               under_alice total_districts prop_under_alice
  &lt;chr&gt;                               &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
1 Non-metropolitan Fast Growing         238             311            0.765
2 &lt;NA&gt;                                   18              24            0.75 
3 Other Central City Suburban           891            1519            0.587
4 Rural                                2327            4233            0.55 
5 Non-metropolitan Stable               884            1647            0.537
6 Independent Town                      240             489            0.491
7 Other Central City                    148             321            0.461
8 Major Suburban                        273             677            0.403
9 Major Urban                            32             101            0.317</code></pre>
</div>
</div>
<p>Now here’s the same thing but for the bill categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  bill_category under_alice total_districts prop_under_alice
  &lt;fct&gt;               &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
1 under 300            1077            1861            0.579
2 under 1600           2192            3930            0.558
3 under 5000           1007            1819            0.554
4 over 5000             775            1712            0.453</code></pre>
</div>
</div>
</section>
<section id="proportion-abovebelow-alice-over-time" class="level2">
<h2 class="anchored" data-anchor-id="proportion-abovebelow-alice-over-time">Proportion above/below alice over time</h2>
<p>Now let’s do the same thing as above but look at it over time so I can graph it. First for tea categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_tea <span class="ot">&lt;-</span> above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_tea</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 5
# Groups:   tea_description [9]
   tea_description         end_year under_alice total_districts prop_under_alice
   &lt;chr&gt;                   &lt;chr&gt;          &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
 1 Major Urban             2022               2               2            1    
 2 Non-metropolitan Fast … 2022               5               5            1    
 3 &lt;NA&gt;                    2015               5               5            1    
 4 &lt;NA&gt;                    2020               2               2            1    
 5 &lt;NA&gt;                    2021               1               1            1    
 6 Non-metropolitan Stable 2022              16              18            0.889
 7 Non-metropolitan Fast … 2019              30              34            0.882
 8 Major Suburban          2022               7               8            0.875
 9 Non-metropolitan Fast … 2018              29              34            0.853
10 Non-metropolitan Fast … 2023              29              34            0.853
# ℹ 77 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(above_below_alice_over_time_tea, </span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, </span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> prop_under_alice, </span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> tea_description, </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> tea_description)) <span class="sc">+</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Graph of where each district type is</p>
<p>Now for the bill categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_bill <span class="ot">&lt;-</span> above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'bill_category'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_bill</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 5
# Groups:   bill_category [4]
   bill_category end_year under_alice total_districts prop_under_alice
   &lt;fct&gt;         &lt;chr&gt;          &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
 1 under 1600    2022              45              50            0.9  
 2 under 5000    2022              26              29            0.897
 3 under 300     2022              19              25            0.76 
 4 over 5000     2022              15              20            0.75 
 5 under 300     2019             150             201            0.746
 6 under 300     2018             147             199            0.739
 7 under 1600    2018             319             436            0.732
 8 under 1600    2019             316             433            0.73 
 9 under 5000    2018             143             197            0.726
10 over 5000     2019             135             188            0.718
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(above_below_alice_over_time_bill, </span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, </span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> prop_under_alice, </span>
<span id="cb89-4"><a href="#cb89-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bill_category, </span>
<span id="cb89-5"><a href="#cb89-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> bill_category)) <span class="sc">+</span></span>
<span id="cb89-6"><a href="#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb89-7"><a href="#cb89-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-and-median-salary-and-alice-threshold-for-each-category" class="level2">
<h2 class="anchored" data-anchor-id="average-and-median-salary-and-alice-threshold-for-each-category">Average and median salary and alice threshold for each category</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_salary =</span> <span class="fu">mean</span>(average_base_pay),</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_salary =</span> <span class="fu">median</span>(average_base_pay),</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_threshold =</span> <span class="fu">mean</span>(alice_threshold_hh_under_65),</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_threshold =</span> <span class="fu">median</span>(alice_threshold_hh_under_65), </span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 6
  tea_description        avg_salary median_salary avg_threshold median_threshold
  &lt;chr&gt;                       &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
1 Independent Town           50136.         49620        50555.           50000 
2 Major Suburban             58052.         57547        57380.           60000 
3 Major Urban                57297.         56337        55484.           50000 
4 Non-metropolitan Fast…     50176.         50158        55544.           56064.
5 Non-metropolitan Stab…     50440.         50048        51740.           50000 
6 Other Central City         54689.         54134        54484.           50000 
7 Other Central City Su…     52466.         52000        54168.           50000 
8 Rural                      48252.         47627        49295.           50000 
9 &lt;NA&gt;                       42779.         42652        45833.           45000 
# ℹ 1 more variable: total_districts &lt;int&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_salary =</span> <span class="fu">mean</span>(average_base_pay),</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_salary =</span> <span class="fu">median</span>(average_base_pay),</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">avg_threshold =</span> <span class="fu">mean</span>(alice_threshold_hh_under_65),</span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_threshold =</span> <span class="fu">median</span>(alice_threshold_hh_under_65),</span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 6
  bill_category avg_salary median_salary avg_threshold median_threshold
  &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;         &lt;dbl&gt;            &lt;dbl&gt;
1 under 300         47694.        46874         48984.           50000 
2 under 1600        48984.        48473         50409.           50000 
3 under 5000        51518.        50847         52970.           50000 
4 over 5000         55979.        55758.        55828.           59327.
# ℹ 1 more variable: total_districts &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="nces-district-types" class="level2">
<h2 class="anchored" data-anchor-id="nces-district-types">NCES District Types</h2>
<section id="count-and-average-pay-for-nces" class="level3">
<h3 class="anchored" data-anchor-id="count-and-average-pay-for-nces">Count and Average Pay for NCES</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">group_by</span>(nces_description) <span class="sc">|&gt;</span> <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 2
# Groups:   nces_description [13]
   nces_description     n
   &lt;chr&gt;            &lt;int&gt;
 1 City-Large         305
 2 City-Midsize       166
 3 City-Small         200
 4 Rural-Distant     2780
 5 Rural-Fringe      1087
 6 Rural-Remote      1985
 7 Suburb-Large       672
 8 Suburb-Midsize     226
 9 Suburb-Small        46
10 Town-Distant       859
11 Town-Fringe        291
12 Town-Remote        681
13 &lt;NA&gt;                24</code></pre>
</div>
</div>
<p>Finding average pay per school year for each NCES district type.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>district_types_nces_chart <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">group_by</span>(nces_description, school_year) <span class="sc">|&gt;</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'nces_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>district_types_nces_chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 127 × 3
# Groups:   nces_description [13]
   nces_description school_year avg_pay
   &lt;chr&gt;            &lt;chr&gt;         &lt;dbl&gt;
 1 City-Large       2014-2015    52463.
 2 City-Large       2015-2016    53582.
 3 City-Large       2016-2017    54324.
 4 City-Large       2017-2018    55315.
 5 City-Large       2018-2019    55907.
 6 City-Large       2019-2020    58484.
 7 City-Large       2020-2021    58959.
 8 City-Large       2021-2022    60901.
 9 City-Large       2022-2023    61563.
10 City-Large       2023-2024    63822.
# ℹ 117 more rows</code></pre>
</div>
</div>
<p>Graphing it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(district_types_nces_chart, <span class="fu">aes</span>(<span class="at">x =</span> school_year, <span class="at">y =</span> avg_pay, <span class="at">color =</span> nces_description, <span class="at">group =</span> nces_description)) <span class="sc">+</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="average-and-median-of-difference-between-salary-and-alice-for-each-nces-district-type" class="level3">
<h3 class="anchored" data-anchor-id="average-and-median-of-difference-between-salary-and-alice-for-each-nces-district-type">Average and Median of difference between salary and ALICE for each NCES district type</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(nces_description) <span class="sc">|&gt;</span> </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference),</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference),</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">number_of_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(avg_difference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 13 × 4
   nces_description avg_difference median_difference number_of_districts
   &lt;chr&gt;                     &lt;dbl&gt;             &lt;dbl&gt;               &lt;int&gt;
 1 Town-Fringe             -3887.             -2854                  291
 2 &lt;NA&gt;                    -3055.             -2348                   24
 3 Rural-Distant           -2597.             -2000.                2780
 4 Rural-Fringe            -2192.             -1501                 1087
 5 Town-Distant            -1356.              -970                  859
 6 Rural-Remote               68.7               38                 1985
 7 Town-Remote                84.5              825                  681
 8 Suburb-Large              257.               844                  672
 9 City-Small                566.               914                  200
10 Suburb-Midsize            695.               646                  226
11 Suburb-Small             1306.              1204                   46
12 City-Large               1851.              1823                  305
13 City-Midsize             1948.              2263                  166</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time_nces <span class="ot">&lt;-</span> salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(nces_description, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'nces_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time_nces</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 127 × 3
# Groups:   nces_description [13]
   nces_description end_year avg_difference
   &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;
 1 City-Large       2015              2311.
 2 City-Large       2016              3430.
 3 City-Large       2017              4172.
 4 City-Large       2018               769.
 5 City-Large       2019               453.
 6 City-Large       2020              2896.
 7 City-Large       2021               577.
 8 City-Large       2022             -3714 
 9 City-Large       2023               251.
10 City-Large       2024              2510.
# ℹ 117 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_difference_over_time_nces, </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, <span class="at">y =</span> avg_difference, <span class="at">color =</span> nces_description, <span class="at">group =</span> nces_description)) <span class="sc">+</span> </span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>,<span class="dv">5000</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Analysis_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="same-as-above-but-for-region-13" class="level3">
<h3 class="anchored" data-anchor-id="same-as-above-but-for-region-13">Same as above but for region 13</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>region_13 <span class="sc">|&gt;</span> <span class="fu">group_by</span>(nces_description) <span class="sc">|&gt;</span> </span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference),</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference),</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">number_of_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(avg_difference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 10 × 4
   nces_description avg_difference median_difference number_of_districts
   &lt;chr&gt;                     &lt;dbl&gt;             &lt;dbl&gt;               &lt;int&gt;
 1 City-Midsize            -10486.            -9070                    9
 2 Town-Fringe             -10374.            -9098.                  40
 3 Rural-Distant           -10300.           -10806.                 110
 4 City-Small               -7497.            -5844                   25
 5 Suburb-Large             -7030.            -4838                   47
 6 Rural-Fringe             -5473.            -3907                   87
 7 Town-Distant             -2725.             -913                   45
 8 City-Large               -2433.            -3338.                  14
 9 Rural-Remote              -271.               -1                   79
10 Town-Remote               3362.             4292                   27</code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>