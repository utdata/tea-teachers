<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AnalysisTEASalaries – tea-teachers</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dcc7d9e706e4adfbab8e3d6c7c60bab2.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./AnalysisInitial.html">AnalysisTEASalaries</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">tea-teachers</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./about.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">About</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AnalysisInitial.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">AnalysisTEASalaries</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AnalysisNCES.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AnalysisNCES</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./AnalysisRegion20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">AnalysisRegion20</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CleaningCPI-ALICE.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CleaningCPI</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CleaningEnrollment.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CleaningEnrollment</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CleaningTEASalaries.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning TEA Salaries</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#setup" id="toc-setup" class="nav-link active" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#read-in-cleaned-data" id="toc-read-in-cleaned-data" class="nav-link" data-scroll-target="#read-in-cleaned-data">Read in cleaned data</a></li>
  <li><a href="#with-district-types" id="toc-with-district-types" class="nav-link" data-scroll-target="#with-district-types">With District Types</a>
  <ul class="collapse">
  <li><a href="#chart" id="toc-chart" class="nav-link" data-scroll-target="#chart">Chart</a></li>
  </ul></li>
  <li><a href="#adding-cost-of-living" id="toc-adding-cost-of-living" class="nav-link" data-scroll-target="#adding-cost-of-living">Adding Cost of Living</a></li>
  <li><a href="#bill-categories" id="toc-bill-categories" class="nav-link" data-scroll-target="#bill-categories">Bill Categories</a></li>
  <li><a href="#proportion-of-districts-with-salary-above-and-below-alice-line" id="toc-proportion-of-districts-with-salary-above-and-below-alice-line" class="nav-link" data-scroll-target="#proportion-of-districts-with-salary-above-and-below-alice-line">Proportion of districts with salary above and below alice line</a></li>
  <li><a href="#proportion-abovebelow-alice-over-time" id="toc-proportion-abovebelow-alice-over-time" class="nav-link" data-scroll-target="#proportion-abovebelow-alice-over-time">Proportion above/below alice over time</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">AnalysisTEASalaries</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="setup" class="level2">
<h2 class="anchored" data-anchor-id="setup">Setup</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mapview)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="read-in-cleaned-data" class="level2">
<h2 class="anchored" data-anchor-id="read-in-cleaned-data">Read in cleaned data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_salaries <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/teaching_staff_salaries.rds"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>cpi <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/cpi_201401_202502"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>household_budget_simple <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/alice_household_budget.rds"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>enrollment <span class="ot">&lt;-</span> <span class="fu">read_rds</span>(<span class="st">"data-processed/enrollment-by-district.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now I want to only look at totals for teaching staff at each district. I also want to exclude charters and exclude the weird small pay amounts.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals_no_enroll <span class="ot">&lt;-</span> teaching_staff_salaries <span class="sc">|&gt;</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(staff <span class="sc">==</span> <span class="st">"TOTAL TEACHING STAFF"</span> <span class="sc">&amp;</span> average_base_pay <span class="sc">&gt;</span> <span class="dv">10000</span> <span class="sc">&amp;</span> charter_status <span class="sc">==</span> <span class="st">"TRADITIONAL ISD/CSD"</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals_no_enroll</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 18
   region county   district_number district_name.x charter_status staff_category
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
 1 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 2 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
 3 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
 4 07     ANDERSO… 001906          NECHES ISD      TRADITIONAL I… TEACHING STAFF
 5 07     ANDERSO… 001907          PALESTINE ISD   TRADITIONAL I… TEACHING STAFF
 6 07     ANDERSO… 001908          WESTWOOD ISD    TRADITIONAL I… TEACHING STAFF
 7 07     ANDERSO… 001909          SLOCUM ISD      TRADITIONAL I… TEACHING STAFF
 8 18     ANDREWS… 002901          ANDREWS ISD     TRADITIONAL I… TEACHING STAFF
 9 07     ANGELIN… 003902          HUDSON ISD      TRADITIONAL I… TEACHING STAFF
10 07     ANGELIN… 003903          LUFKIN ISD      TRADITIONAL I… TEACHING STAFF
# ℹ 9,312 more rows
# ℹ 12 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;fct&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;</code></pre>
</div>
</div>
<p>I want to add enrollment to this dataframe.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="ot">&lt;-</span> teaching_staff_totals_no_enroll <span class="sc">|&gt;</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">left_join</span>(enrollment, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"district_name.x"</span> <span class="ot">=</span> <span class="st">"district_name"</span>, <span class="st">"school_year"</span> <span class="ot">=</span> <span class="st">"year"</span>))</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">tail</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 19
  region county    district_number district_name.x charter_status staff_category
  &lt;chr&gt;  &lt;chr&gt;     &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
1 03     DEWITT C… 062903          YOAKUM ISD      TRADITIONAL I… TEACHING STAFF
2 03     DEWITT C… 062904          YORKTOWN ISD    TRADITIONAL I… TEACHING STAFF
3 19     EL PASO … 071905          YSLETA ISD      TRADITIONAL I… TEACHING STAFF
4 01     ZAPATA C… 253901          ZAPATA COUNTY … TRADITIONAL I… TEACHING STAFF
5 07     ANGELINA… 003906          ZAVALLA ISD     TRADITIONAL I… TEACHING STAFF
6 15     BROWN CO… 025906          ZEPHYR ISD      TRADITIONAL I… TEACHING STAFF
# ℹ 13 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;chr&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;,
#   total_enrollment &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now let’s look at the average pay per district per year so we can look at it over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_average_school_years <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(district_name.x, school_year) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'district_name.x'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_average_school_years</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,222 × 3
# Groups:   district_name.x [1,023]
   district_name.x school_year avg_pay
   &lt;chr&gt;           &lt;chr&gt;         &lt;dbl&gt;
 1 ABBOTT ISD      2014-2015     42066
 2 ABBOTT ISD      2015-2016     43863
 3 ABBOTT ISD      2016-2017     43346
 4 ABBOTT ISD      2017-2018     45447
 5 ABBOTT ISD      2018-2019     44707
 6 ABBOTT ISD      2019-2020     52540
 7 ABBOTT ISD      2020-2021     51449
 8 ABBOTT ISD      2021-2022     54155
 9 ABBOTT ISD      2022-2023     55584
10 ABBOTT ISD      2023-2024     54927
# ℹ 9,212 more rows</code></pre>
</div>
</div>
<p>Okay there’s too many schools for us to graph these all at once. Maybe if we just do one region (central texas, 13).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>austin_schools <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">filter</span>(region <span class="sc">==</span> <span class="st">"13"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(district_name.x, school_year) <span class="sc">|&gt;</span> <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'district_name.x'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>austin_schools</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 483 × 3
# Groups:   district_name.x [57]
   district_name.x school_year avg_pay
   &lt;chr&gt;           &lt;chr&gt;         &lt;dbl&gt;
 1 AUSTIN ISD      2014-2015     47476
 2 AUSTIN ISD      2015-2016     48631
 3 AUSTIN ISD      2016-2017     50144
 4 AUSTIN ISD      2017-2018     52397
 5 AUSTIN ISD      2018-2019     51464
 6 AUSTIN ISD      2019-2020     54707
 7 AUSTIN ISD      2020-2021     55849
 8 AUSTIN ISD      2021-2022     56424
 9 AUSTIN ISD      2022-2023     58511
10 AUSTIN ISD      2023-2024     60821
# ℹ 473 more rows</code></pre>
</div>
</div>
<p>That’s still too many to be understandable on a graph. Let’s instead look at just one district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>austin <span class="ot">&lt;-</span> austin_schools <span class="sc">|&gt;</span> <span class="fu">filter</span>(district_name.x <span class="sc">==</span> <span class="st">"AUSTIN ISD"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(austin, <span class="fu">aes</span>(<span class="at">x =</span> school_year, <span class="at">y =</span> avg_pay, <span class="at">color =</span> district_name.x, <span class="at">group =</span> district_name.x)) <span class="sc">+</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AnalysisInitial_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#facet_wrap(~district_name)    # we can use this if we are looking at multiple districts</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(teaching_staff_totals, <span class="st">"data-processed/teaching_staff_totals.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="with-district-types" class="level2">
<h2 class="anchored" data-anchor-id="with-district-types">With District Types</h2>
<p>I want to see how many districts are in each category from TEA in 2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"total_districts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 2
# Groups:   tea_description [9]
  tea_description               total_districts
  &lt;chr&gt;                                   &lt;int&gt;
1 Independent Town                          489
2 Major Suburban                            677
3 Major Urban                               101
4 Non-metropolitan Fast Growing             311
5 Non-metropolitan Stable                  1647
6 Other Central City                        321
7 Other Central City Suburban              1519
8 Rural                                    4233
9 &lt;NA&gt;                                       24</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">filter</span>(school_year <span class="sc">==</span> <span class="st">"2023-2024"</span>) <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> <span class="fu">count</span>(<span class="at">name =</span> <span class="st">"total_districts"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 2
# Groups:   tea_description [8]
  tea_description               total_districts
  &lt;chr&gt;                                   &lt;int&gt;
1 Independent Town                           53
2 Major Suburban                             75
3 Major Urban                                11
4 Non-metropolitan Fast Growing              34
5 Non-metropolitan Stable                   181
6 Other Central City                         35
7 Other Central City Suburban               167
8 Rural                                     464</code></pre>
</div>
</div>
<p>Now I want to see the average pay for each TEA district type for each school year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>district_types_tea_chart <span class="ot">&lt;-</span> teaching_staff_totals <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, school_year) <span class="sc">|&gt;</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_pay =</span> <span class="fu">mean</span>(average_base_pay))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>district_types_tea_chart</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 3
# Groups:   tea_description [9]
   tea_description  school_year avg_pay
   &lt;chr&gt;            &lt;chr&gt;         &lt;dbl&gt;
 1 Independent Town 2014-2015    45775.
 2 Independent Town 2015-2016    46330.
 3 Independent Town 2016-2017    46938.
 4 Independent Town 2017-2018    47376.
 5 Independent Town 2018-2019    47945.
 6 Independent Town 2019-2020    51791.
 7 Independent Town 2020-2021    52313.
 8 Independent Town 2021-2022    52986.
 9 Independent Town 2022-2023    54895.
10 Independent Town 2023-2024    57213.
# ℹ 77 more rows</code></pre>
</div>
</div>
<section id="chart" class="level3">
<h3 class="anchored" data-anchor-id="chart">Chart</h3>
<p>Now let’s chart it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(district_types_tea_chart, <span class="fu">aes</span>(<span class="at">x =</span> school_year, <span class="at">y =</span> avg_pay, <span class="at">color =</span> tea_description, <span class="at">group =</span> tea_description)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>) <span class="sc">+</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AnalysisInitial_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="adding-cost-of-living" class="level2">
<h2 class="anchored" data-anchor-id="adding-cost-of-living">Adding Cost of Living</h2>
<p>Now that we have ALICE’s household survival budget, I can use it to compare that to each districts salaries.</p>
<p>Now, I am going to left join it on both the county and year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>salaries_col <span class="ot">&lt;-</span> <span class="fu">left_join</span>(teaching_staff_totals, household_budget_simple, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"county"</span>, <span class="st">"end_year"</span>))</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>salaries_col</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 20
   region county   district_number district_name.x charter_status staff_category
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
 1 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 2 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
 3 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
 4 07     ANDERSO… 001906          NECHES ISD      TRADITIONAL I… TEACHING STAFF
 5 07     ANDERSO… 001907          PALESTINE ISD   TRADITIONAL I… TEACHING STAFF
 6 07     ANDERSO… 001908          WESTWOOD ISD    TRADITIONAL I… TEACHING STAFF
 7 07     ANDERSO… 001909          SLOCUM ISD      TRADITIONAL I… TEACHING STAFF
 8 18     ANDREWS… 002901          ANDREWS ISD     TRADITIONAL I… TEACHING STAFF
 9 07     ANGELIN… 003902          HUDSON ISD      TRADITIONAL I… TEACHING STAFF
10 07     ANGELIN… 003903          LUFKIN ISD      TRADITIONAL I… TEACHING STAFF
# ℹ 9,312 more rows
# ℹ 14 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;chr&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;,
#   total_enrollment &lt;dbl&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>There are a few years that are inconsistent between the datasets. But since I have data around each year, I can use that. For example, I want to use 2016 for 2015 when needed. But, I also want to use 2022 for 2024 when needed. So I am going to fill up first, then down in each county.</p>
<p>First, I am going to it out with a single district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>testing_filling <span class="ot">&lt;-</span> salaries_col <span class="sc">|&gt;</span> <span class="fu">filter</span>(county <span class="sc">==</span> <span class="st">"ANDERSON COUNTY"</span>) <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  county, district_name.x, district_number, school_year, end_year, alice_threshold_hh_under_65) <span class="sc">|&gt;</span> </span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(alice_threshold_hh_under_65, <span class="at">.direction =</span> <span class="st">"updown"</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>testing_filling</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 63 × 6
   county          district_name.x district_number school_year end_year
   &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;       &lt;chr&gt;   
 1 ANDERSON COUNTY CAYUGA ISD      001902          2014-2015   2015    
 2 ANDERSON COUNTY ELKHART ISD     001903          2014-2015   2015    
 3 ANDERSON COUNTY FRANKSTON ISD   001904          2014-2015   2015    
 4 ANDERSON COUNTY NECHES ISD      001906          2014-2015   2015    
 5 ANDERSON COUNTY PALESTINE ISD   001907          2014-2015   2015    
 6 ANDERSON COUNTY WESTWOOD ISD    001908          2014-2015   2015    
 7 ANDERSON COUNTY SLOCUM ISD      001909          2014-2015   2015    
 8 ANDERSON COUNTY CAYUGA ISD      001902          2015-2016   2016    
 9 ANDERSON COUNTY ELKHART ISD     001903          2015-2016   2016    
10 ANDERSON COUNTY FRANKSTON ISD   001904          2015-2016   2016    
# ℹ 53 more rows
# ℹ 1 more variable: alice_threshold_hh_under_65 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Actually, I want to fill down first then up, because I want to use the previous year when necessary instead of a future year and then for 2015 I will use 2016.</p>
<p>I’ll do it for all of the data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>salaries_col_fill <span class="ot">&lt;-</span> salaries_col <span class="sc">|&gt;</span> <span class="fu">arrange</span>(county, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(county) <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">fill</span>(alice_threshold_hh_under_65, <span class="at">.direction =</span> <span class="st">"downup"</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>salaries_col_fill</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 20
# Groups:   county [253]
   region county   district_number district_name.x charter_status staff_category
   &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;           &lt;chr&gt;           &lt;chr&gt;          &lt;chr&gt;         
 1 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 2 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
 3 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
 4 07     ANDERSO… 001906          NECHES ISD      TRADITIONAL I… TEACHING STAFF
 5 07     ANDERSO… 001907          PALESTINE ISD   TRADITIONAL I… TEACHING STAFF
 6 07     ANDERSO… 001908          WESTWOOD ISD    TRADITIONAL I… TEACHING STAFF
 7 07     ANDERSO… 001909          SLOCUM ISD      TRADITIONAL I… TEACHING STAFF
 8 07     ANDERSO… 001902          CAYUGA ISD      TRADITIONAL I… TEACHING STAFF
 9 07     ANDERSO… 001903          ELKHART ISD     TRADITIONAL I… TEACHING STAFF
10 07     ANDERSO… 001904          FRANKSTON ISD   TRADITIONAL I… TEACHING STAFF
# ℹ 9,312 more rows
# ℹ 14 more variables: staff &lt;chr&gt;, fte_count &lt;dbl&gt;, total_base_pay &lt;dbl&gt;,
#   average_base_pay &lt;dbl&gt;, school_year &lt;chr&gt;, district_name.y &lt;chr&gt;,
#   tea_district_type &lt;chr&gt;, tea_description &lt;chr&gt;, nces_district_type &lt;chr&gt;,
#   nces_description &lt;chr&gt;, charter_school_y_n &lt;chr&gt;, end_year &lt;chr&gt;,
#   total_enrollment &lt;dbl&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now I want to see the difference between the ALICE budget and the average salary for each district.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="ot">&lt;-</span> salaries_col_fill <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">difference =</span> (average_base_pay <span class="sc">-</span> alice_threshold_hh_under_65) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>()</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  region, county, <span class="st">"district_name"</span> <span class="ot">=</span> <span class="st">"district_name.x"</span>, district_number, total_enrollment, average_base_pay, school_year, end_year, tea_description, nces_description, alice_threshold_hh_under_65, difference</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>salary_col_comparison</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 12
# Groups:   county [253]
   region county district_name district_number total_enrollment average_base_pay
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt;
 1 07     ANDER… CAYUGA ISD    001902                       577            44925
 2 07     ANDER… ELKHART ISD   001903                      1217            41985
 3 07     ANDER… FRANKSTON ISD 001904                       803            41609
 4 07     ANDER… NECHES ISD    001906                       370            42884
 5 07     ANDER… PALESTINE ISD 001907                      3353            43642
 6 07     ANDER… WESTWOOD ISD  001908                      1596            42097
 7 07     ANDER… SLOCUM ISD    001909                       389            44371
 8 07     ANDER… CAYUGA ISD    001902                       570            45359
 9 07     ANDER… ELKHART ISD   001903                      1244            44248
10 07     ANDER… FRANKSTON ISD 001904                       842            43165
# ℹ 9,312 more rows
# ℹ 6 more variables: school_year &lt;chr&gt;, end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(salary_col_comparison, <span class="st">"data-processed/salary_col_comparison.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s look at the districts with the lowest values for difference in salary and ALICE, which means the most negative. I want to see the worst 10 for each year.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(end_year) <span class="sc">|&gt;</span> <span class="fu">slice_min</span>(difference, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 12
# Groups:   end_year [10]
   region county district_name district_number total_enrollment average_base_pay
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt;
 1 13     WILLI… COUPLAND ISD  246914                       142            38142
 2 15     EDWAR… ROCKSPRINGS … 069901                       257            38959
 3 15     EDWAR… NUECES CANYO… 069902                       297            39233
 4 15     CONCH… PAINT ROCK I… 048903                       211            40007
 5 10     ELLIS… ITALY ISD     070907                       577            40555
 6 18     REEVE… BALMORHEA ISD 195902                       161            40923
 7 13     WILLI… GRANGER ISD   246905                       426            41634
 8 06     WALKE… NEW WAVERLY … 236901                       964            41915
 9 10     ELLIS… PALMER ISD    070910                      1145            42028
10 13     WILLI… THRALL ISD    246912                       655            42164
# ℹ 90 more rows
# ℹ 6 more variables: school_year &lt;chr&gt;, end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now let’s see the best 10 for each year (most positive).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(end_year) <span class="sc">|&gt;</span> <span class="fu">slice_max</span>(difference, <span class="at">n =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 100 × 12
# Groups:   end_year [10]
   region county district_name district_number total_enrollment average_base_pay
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt;
 1 20     KERR … DIVIDE ISD    133905                  -9999993            63861
 2 17     KENT … JAYTON-GIRAR… 132902                       130            51405
 3 11     SOMER… GLEN ROSE ISD 213901                      1667            55351
 4 17     BORDE… BORDEN COUNT… 017901                       249            60208
 5 03     MATAG… PALACIOS ISD  158905                      1442            54612
 6 04     CHAMB… BARBERS HILL… 036902                      4903            64376
 7 18     TERRE… TERRELL COUN… 222901                       142            49273
 8 18     BREWS… SAN VICENTE … 022903                        29            48777
 9 16     OLDHA… BOYS RANCH I… 180901                       281            53602
10 17     KING … GUTHRIE CSD   135001                       115            53465
# ℹ 90 more rows
# ℹ 6 more variables: school_year &lt;chr&gt;, end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;, difference &lt;dbl&gt;</code></pre>
</div>
</div>
<p>Now I want to see the average difference, median difference and count of districts for each TEA district type category.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference),</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference),</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">number_of_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>            <span class="co"># fix number of districts, maybe</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(avg_difference)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  tea_description           avg_difference median_difference number_of_districts
  &lt;chr&gt;                              &lt;dbl&gt;             &lt;dbl&gt;               &lt;int&gt;
1 Non-metropolitan Fast Gr…         -5368.             -4581                 311
2 &lt;NA&gt;                              -3055.             -2348                  24
3 Other Central City Subur…         -1702.             -1109                1519
4 Non-metropolitan Stable           -1300.              -527                1647
5 Rural                             -1043.              -719                4233
6 Independent Town                   -420.                60                 489
7 Other Central City                  205.               566                 321
8 Major Suburban                      673.              1243                 677
9 Major Urban                        1813.              2157                 101</code></pre>
</div>
</div>
<p>Now I want to look at the average difference over time.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time <span class="ot">&lt;-</span> salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>avg_difference_over_time</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 3
# Groups:   tea_description [9]
   tea_description  end_year avg_difference
   &lt;chr&gt;            &lt;chr&gt;             &lt;dbl&gt;
 1 Independent Town 2015               398.
 2 Independent Town 2016               952.
 3 Independent Town 2017              1560.
 4 Independent Town 2018             -2813.
 5 Independent Town 2019             -3092.
 6 Independent Town 2020               753.
 7 Independent Town 2021              -234.
 8 Independent Town 2022             -5187.
 9 Independent Town 2023             -1271.
10 Independent Town 2024              1047.
# ℹ 77 more rows</code></pre>
</div>
</div>
<p>Let’s graph it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_difference_over_time, </span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, <span class="at">y =</span> avg_difference, <span class="at">color =</span> tea_description, <span class="at">group =</span> tea_description)) <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>,<span class="dv">5000</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AnalysisInitial_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This graph shows the average difference between a district’s salary and the ALICE cost of living threshold for each TEA district type over time.</p>
</section>
<section id="bill-categories" class="level2">
<h2 class="anchored" data-anchor-id="bill-categories">Bill Categories</h2>
<p>I am going to create a bill category column that includes the different categories the SB and HB have defined as important to the bill. These numbers incluse 5000, 1600 and 300.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="ot">&lt;-</span>salary_col_comparison <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">bill_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&gt;=</span> <span class="dv">5000</span> <span class="sc">~</span> <span class="st">"over 5000"</span>,</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&lt;</span> <span class="dv">300</span> <span class="sc">~</span> <span class="st">"under 300"</span>,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&lt;</span> <span class="dv">1600</span> <span class="sc">~</span> <span class="st">"under 1600"</span>,</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>    total_enrollment <span class="sc">&lt;</span> <span class="dv">5000</span> <span class="sc">~</span> <span class="st">"under 5000"</span>)</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">bill_category =</span> <span class="fu">factor</span>(bill_category, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"under 300"</span>, <span class="st">"under 1600"</span>, <span class="st">"under 5000"</span>, <span class="st">"over 5000"</span>))</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a>bill_category_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 13
# Groups:   county [253]
   region county district_name district_number total_enrollment average_base_pay
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt;
 1 07     ANDER… CAYUGA ISD    001902                       577            44925
 2 07     ANDER… ELKHART ISD   001903                      1217            41985
 3 07     ANDER… FRANKSTON ISD 001904                       803            41609
 4 07     ANDER… NECHES ISD    001906                       370            42884
 5 07     ANDER… PALESTINE ISD 001907                      3353            43642
 6 07     ANDER… WESTWOOD ISD  001908                      1596            42097
 7 07     ANDER… SLOCUM ISD    001909                       389            44371
 8 07     ANDER… CAYUGA ISD    001902                       570            45359
 9 07     ANDER… ELKHART ISD   001903                      1244            44248
10 07     ANDER… FRANKSTON ISD 001904                       842            43165
# ℹ 9,312 more rows
# ℹ 7 more variables: school_year &lt;chr&gt;, end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;,
#   difference &lt;dbl&gt;, bill_category &lt;fct&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(bill_category_df, <span class="st">"data-processed/bill_cateogry_df.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>I am going to use the column bill_category to look at what the col vs salary looks like for the categories the bill wants to target. This is the same concept as above but for these bill categories instead of tea categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference, <span class="at">na.rm =</span> T),</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference, <span class="at">na.rm =</span> T),</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts_since_2015 =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  bill_category avg_difference median_difference total_districts_since_2015
  &lt;fct&gt;                  &lt;dbl&gt;             &lt;dbl&gt;                      &lt;int&gt;
1 under 300             -1291.            -1058                        1861
2 under 1600            -1426.             -822.                       3930
3 under 5000            -1451.             -680                        1819
4 over 5000               151.              616                        1712</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>bill_category_df <span class="sc">|&gt;</span> <span class="fu">filter</span>(end_year <span class="sc">==</span> <span class="dv">2024</span>) <span class="sc">|&gt;</span> </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference, <span class="at">na.rm =</span> T),</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">median_difference =</span> <span class="fu">median</span>(difference, <span class="at">na.rm =</span> T),</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts_2024 =</span> <span class="fu">n</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  bill_category avg_difference median_difference total_districts_2024
  &lt;fct&gt;                  &lt;dbl&gt;             &lt;dbl&gt;                &lt;int&gt;
1 under 300              649.               542.                  206
2 under 1600            -399.               207                   425
3 under 5000              85.3              284                   196
4 over 5000             1218.              1312                   193</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>avg_difference_bill_category <span class="ot">&lt;-</span> bill_category_df <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">avg_difference =</span> <span class="fu">mean</span>(difference, <span class="at">na.rm =</span> T))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'bill_category'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>avg_difference_bill_category</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 3
# Groups:   bill_category [4]
   bill_category end_year avg_difference
   &lt;fct&gt;         &lt;chr&gt;             &lt;dbl&gt;
 1 under 300     2015             -1794.
 2 under 300     2016              -951.
 3 under 300     2017              -511.
 4 under 300     2018             -4323.
 5 under 300     2019             -3810.
 6 under 300     2020              1470.
 7 under 300     2021             -1109.
 8 under 300     2022             -6138.
 9 under 300     2023              -709.
10 under 300     2024               649.
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(avg_difference_bill_category, </span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, <span class="at">y =</span> avg_difference, <span class="at">color =</span> bill_category, <span class="at">group =</span> bill_category)) <span class="sc">+</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10000</span>,<span class="dv">5000</span>), <span class="at">n.breaks =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AnalysisInitial_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="proportion-of-districts-with-salary-above-and-below-alice-line" class="level2">
<h2 class="anchored" data-anchor-id="proportion-of-districts-with-salary-above-and-below-alice-line">Proportion of districts with salary above and below alice line</h2>
<p>I want to know how many districts have salaries that meet the ALICE line or not. And find the proportion of of those districts for each TEA district type and based on the bill categories for districts.</p>
<p>First, I want to create a column that indicates if the salary is above or below ALICE.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="co"># in a district category whats the number of districts where the salary is below alice for that district dividied by the total number of districts in that category</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="ot">&lt;-</span> bill_category_df <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">above_alice =</span> <span class="fu">case_when</span>(</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>    average_base_pay <span class="sc">&gt;=</span> alice_threshold_hh_under_65 <span class="sc">~</span> T,</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> F</span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>above_below_alice</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9,322 × 14
# Groups:   county [253]
   region county district_name district_number total_enrollment average_base_pay
   &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;         &lt;chr&gt;                      &lt;dbl&gt;            &lt;dbl&gt;
 1 07     ANDER… CAYUGA ISD    001902                       577            44925
 2 07     ANDER… ELKHART ISD   001903                      1217            41985
 3 07     ANDER… FRANKSTON ISD 001904                       803            41609
 4 07     ANDER… NECHES ISD    001906                       370            42884
 5 07     ANDER… PALESTINE ISD 001907                      3353            43642
 6 07     ANDER… WESTWOOD ISD  001908                      1596            42097
 7 07     ANDER… SLOCUM ISD    001909                       389            44371
 8 07     ANDER… CAYUGA ISD    001902                       570            45359
 9 07     ANDER… ELKHART ISD   001903                      1244            44248
10 07     ANDER… FRANKSTON ISD 001904                       842            43165
# ℹ 9,312 more rows
# ℹ 8 more variables: school_year &lt;chr&gt;, end_year &lt;chr&gt;, tea_description &lt;chr&gt;,
#   nces_description &lt;chr&gt;, alice_threshold_hh_under_65 &lt;dbl&gt;,
#   difference &lt;dbl&gt;, bill_category &lt;fct&gt;, above_alice &lt;lgl&gt;</code></pre>
</div>
</div>
<p>Now I am goint to count the number of districts below alice, count the total number of districts in each tea district group and then calculate the proportion of districts that fall below the line.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts_since_2015 =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts_since_2015) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 9 × 4
  tea_description            under_alice total_districts_sinc…¹ prop_under_alice
  &lt;chr&gt;                            &lt;int&gt;                  &lt;int&gt;            &lt;dbl&gt;
1 Non-metropolitan Fast Gro…         238                    311            0.765
2 &lt;NA&gt;                                18                     24            0.75 
3 Other Central City Suburb…         891                   1519            0.587
4 Rural                             2327                   4233            0.55 
5 Non-metropolitan Stable            884                   1647            0.537
6 Independent Town                   240                    489            0.491
7 Other Central City                 148                    321            0.461
8 Major Suburban                     273                    677            0.403
9 Major Urban                         32                    101            0.317
# ℹ abbreviated name: ¹​total_districts_since_2015</code></pre>
</div>
</div>
<p>Now I want this for 2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="sc">|&gt;</span> <span class="fu">filter</span>(end_year <span class="sc">==</span> <span class="dv">2024</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(tea_description) <span class="sc">|&gt;</span> </span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts_2024 =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts_2024) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 × 4
  tea_description              under_alice total_districts_2024 prop_under_alice
  &lt;chr&gt;                              &lt;int&gt;                &lt;int&gt;            &lt;dbl&gt;
1 Non-metropolitan Fast Growi…          25                   34            0.735
2 Other Central City Suburban           84                  167            0.503
3 Rural                                220                  464            0.474
4 Independent Town                      22                   53            0.415
5 Non-metropolitan Stable               75                  181            0.414
6 Other Central City                    13                   35            0.371
7 Major Suburban                        22                   75            0.293
8 Major Urban                            2                   11            0.182</code></pre>
</div>
</div>
<p>Now here’s the same thing but for the bill categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts_2024 =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts_2024) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  bill_category under_alice total_districts_2024 prop_under_alice
  &lt;fct&gt;               &lt;int&gt;                &lt;int&gt;            &lt;dbl&gt;
1 under 300            1077                 1861            0.579
2 under 1600           2192                 3930            0.558
3 under 5000           1007                 1819            0.554
4 over 5000             775                 1712            0.453</code></pre>
</div>
</div>
<p>And again but for 2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>above_below_alice <span class="sc">|&gt;</span> <span class="fu">filter</span>(end_year <span class="sc">==</span> <span class="dv">2024</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(bill_category) <span class="sc">|&gt;</span> </span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts_2024 =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts_2024) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 4
  bill_category under_alice total_districts_2024 prop_under_alice
  &lt;fct&gt;               &lt;int&gt;                &lt;int&gt;            &lt;dbl&gt;
1 under 1600            208                  425            0.489
2 under 300              97                  206            0.471
3 under 5000             92                  196            0.469
4 over 5000              66                  193            0.342</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write_rds</span>(above_below_alice, <span class="st">"data-processed/above_below_alice.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="proportion-abovebelow-alice-over-time" class="level2">
<h2 class="anchored" data-anchor-id="proportion-abovebelow-alice-over-time">Proportion above/below alice over time</h2>
<p>Now let’s do the same thing as above but look at it over time so I can graph it. First for tea categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_tea <span class="ot">&lt;-</span> above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(tea_description, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'tea_description'. You can override using
the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_tea</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 87 × 5
# Groups:   tea_description [9]
   tea_description         end_year under_alice total_districts prop_under_alice
   &lt;chr&gt;                   &lt;chr&gt;          &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
 1 Major Urban             2022               2               2            1    
 2 Non-metropolitan Fast … 2022               5               5            1    
 3 &lt;NA&gt;                    2015               5               5            1    
 4 &lt;NA&gt;                    2020               2               2            1    
 5 &lt;NA&gt;                    2021               1               1            1    
 6 Non-metropolitan Stable 2022              16              18            0.889
 7 Non-metropolitan Fast … 2019              30              34            0.882
 8 Major Suburban          2022               7               8            0.875
 9 Non-metropolitan Fast … 2018              29              34            0.853
10 Non-metropolitan Fast … 2023              29              34            0.853
# ℹ 77 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(above_below_alice_over_time_tea, </span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, </span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> prop_under_alice, </span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> tea_description, </span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> tea_description)) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AnalysisInitial_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Now for the bill categories.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_bill <span class="ot">&lt;-</span> above_below_alice <span class="sc">|&gt;</span> <span class="fu">group_by</span>(bill_category, end_year) <span class="sc">|&gt;</span> </span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">under_alice =</span> <span class="fu">sum</span>(above_alice <span class="sc">==</span> <span class="cn">FALSE</span>),</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">total_districts =</span> <span class="fu">n</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">prop_under_alice =</span> (under_alice <span class="sc">/</span> total_districts) <span class="sc">|&gt;</span> <span class="fu">round_half_up</span>(<span class="dv">3</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(prop_under_alice))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'bill_category'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>above_below_alice_over_time_bill</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 40 × 5
# Groups:   bill_category [4]
   bill_category end_year under_alice total_districts prop_under_alice
   &lt;fct&gt;         &lt;chr&gt;          &lt;int&gt;           &lt;int&gt;            &lt;dbl&gt;
 1 under 1600    2022              45              50            0.9  
 2 under 5000    2022              26              29            0.897
 3 under 300     2022              19              25            0.76 
 4 over 5000     2022              15              20            0.75 
 5 under 300     2019             150             201            0.746
 6 under 300     2018             147             199            0.739
 7 under 1600    2018             319             436            0.732
 8 under 1600    2019             316             433            0.73 
 9 under 5000    2018             143             197            0.726
10 over 5000     2019             135             188            0.718
# ℹ 30 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(above_below_alice_over_time_bill, </span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">aes</span>(<span class="at">x =</span> end_year, </span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> prop_under_alice, </span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">color =</span> bill_category, </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">group =</span> bill_category)) <span class="sc">+</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="AnalysisInitial_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Questions from Camille 4/16: Which districts by type have the biggest discrepancy between cost of living and their average salary proportion of districts in each category that are above/below alice threshold How many districts of each type are under 5000 enrollment? What percentage of districts in each type are under 5000 enrollment? How many urban/suburban districts are under 5000 and how do they pay their teachers? This number of districts in texas pay their teachers under living wage (or percentage) What percentage of students are served by teachers that are underpaid?</p>
<p>Spreadsheet from 2024: district type, district name, alice cost of living, avg_salary, difference, county, bill_category, enrollment ALICE methodology</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>